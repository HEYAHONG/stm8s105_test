                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ANSI-C Compiler
                                      3 ; Version 3.8.0 #10562 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module modbus
                                      6 	.optsdcc -mstm8
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _modbus_virtual_read
                                     12 	.globl _modbus_virtual_write
                                     13 	.globl _modbus_send
                                     14 	.globl _beep_off
                                     15 	.globl _beep_on
                                     16 	.globl _beep_read
                                     17 	.globl _eeprom_write
                                     18 	.globl _eeprom_read
                                     19 	.globl _ds1302_write_time
                                     20 	.globl _relay_off
                                     21 	.globl _relay_on
                                     22 	.globl _relay_read
                                     23 	.globl _UART2_GetFlagStatus
                                     24 	.globl _UART2_SendData8
                                     25 	.globl _modbus_status
                                     26 	.globl _modbus_buff
                                     27 	.globl _CRC16
                                     28 	.globl _modbus_process
                                     29 ;--------------------------------------------------------
                                     30 ; ram data
                                     31 ;--------------------------------------------------------
                                     32 	.area DATA
      000000                         33 _modbus_buff::
      000000                         34 	.ds 10
                                     35 ;--------------------------------------------------------
                                     36 ; ram data
                                     37 ;--------------------------------------------------------
                                     38 	.area INITIALIZED
      000000                         39 _modbus_status::
      000000                         40 	.ds 1
                                     41 ;--------------------------------------------------------
                                     42 ; absolute external ram data
                                     43 ;--------------------------------------------------------
                                     44 	.area DABS (ABS)
                                     45 
                                     46 ; default segment ordering for linker
                                     47 	.area HOME
                                     48 	.area GSINIT
                                     49 	.area GSFINAL
                                     50 	.area CONST
                                     51 	.area INITIALIZER
                                     52 	.area CODE
                                     53 
                                     54 ;--------------------------------------------------------
                                     55 ; global & static initialisations
                                     56 ;--------------------------------------------------------
                                     57 	.area HOME
                                     58 	.area GSINIT
                                     59 	.area GSFINAL
                                     60 	.area GSINIT
                                     61 ;--------------------------------------------------------
                                     62 ; Home
                                     63 ;--------------------------------------------------------
                                     64 	.area HOME
                                     65 	.area HOME
                                     66 ;--------------------------------------------------------
                                     67 ; code
                                     68 ;--------------------------------------------------------
                                     69 	.area CODE
                                     70 ;	driver/modbus.c: 8: u16 CRC16(u8 *arr_buff,u8 len)
                                     71 ;	-----------------------------------------
                                     72 ;	 function CRC16
                                     73 ;	-----------------------------------------
      000000                         74 _CRC16:
      000000 52 08            [ 2]   75 	sub	sp, #8
                                     76 ;	driver/modbus.c: 10: u16 crc=0xFFFF;
      000002 AE FF FF         [ 2]   77 	ldw	x, #0xffff
      000005 1F 03            [ 2]   78 	ldw	(0x03, sp), x
                                     79 ;	driver/modbus.c: 12: for ( j=0; j<len;j++)
      000007 16 0B            [ 2]   80 	ldw	y, (0x0b, sp)
      000009 17 01            [ 2]   81 	ldw	(0x01, sp), y
      00000B 0F 07            [ 1]   82 	clr	(0x07, sp)
      00000D                         83 00109$:
      00000D 7B 07            [ 1]   84 	ld	a, (0x07, sp)
      00000F 11 0D            [ 1]   85 	cp	a, (0x0d, sp)
      000011 24 3D            [ 1]   86 	jrnc	00105$
                                     87 ;	driver/modbus.c: 14: crc=crc ^*arr_buff++;
      000013 1E 01            [ 2]   88 	ldw	x, (0x01, sp)
      000015 F6               [ 1]   89 	ld	a, (x)
      000016 1E 01            [ 2]   90 	ldw	x, (0x01, sp)
      000018 5C               [ 1]   91 	incw	x
      000019 1F 01            [ 2]   92 	ldw	(0x01, sp), x
      00001B 90 5F            [ 1]   93 	clrw	y
      00001D 18 04            [ 1]   94 	xor	a, (0x04, sp)
      00001F 97               [ 1]   95 	ld	xl, a
      000020 90 9F            [ 1]   96 	ld	a, yl
      000022 18 03            [ 1]   97 	xor	a, (0x03, sp)
      000024 95               [ 1]   98 	ld	xh, a
      000025 1F 03            [ 2]   99 	ldw	(0x03, sp), x
                                    100 ;	driver/modbus.c: 15: for ( i=0; i<8; i++)
      000027 0F 08            [ 1]  101 	clr	(0x08, sp)
      000029                        102 00106$:
                                    103 ;	driver/modbus.c: 19: crc=crc>>1;
      000029 1E 03            [ 2]  104 	ldw	x, (0x03, sp)
      00002B 54               [ 2]  105 	srlw	x
      00002C 1F 05            [ 2]  106 	ldw	(0x05, sp), x
                                    107 ;	driver/modbus.c: 17: if( ( crc&0x0001) >0)
      00002E 7B 04            [ 1]  108 	ld	a, (0x04, sp)
      000030 44               [ 1]  109 	srl	a
      000031 24 0D            [ 1]  110 	jrnc	00102$
                                    111 ;	driver/modbus.c: 19: crc=crc>>1;
      000033 1E 05            [ 2]  112 	ldw	x, (0x05, sp)
                                    113 ;	driver/modbus.c: 20: crc=crc^ 0xa001;
      000035 9F               [ 1]  114 	ld	a, xl
      000036 A8 01            [ 1]  115 	xor	a, #0x01
      000038 02               [ 1]  116 	rlwa	x
      000039 A8 A0            [ 1]  117 	xor	a, #0xa0
      00003B 95               [ 1]  118 	ld	xh, a
      00003C 1F 03            [ 2]  119 	ldw	(0x03, sp), x
      00003E 20 04            [ 2]  120 	jra	00107$
      000040                        121 00102$:
                                    122 ;	driver/modbus.c: 23: crc=crc>>1;
      000040 16 05            [ 2]  123 	ldw	y, (0x05, sp)
      000042 17 03            [ 2]  124 	ldw	(0x03, sp), y
      000044                        125 00107$:
                                    126 ;	driver/modbus.c: 15: for ( i=0; i<8; i++)
      000044 0C 08            [ 1]  127 	inc	(0x08, sp)
      000046 7B 08            [ 1]  128 	ld	a, (0x08, sp)
      000048 A1 08            [ 1]  129 	cp	a, #0x08
      00004A 25 DD            [ 1]  130 	jrc	00106$
                                    131 ;	driver/modbus.c: 12: for ( j=0; j<len;j++)
      00004C 0C 07            [ 1]  132 	inc	(0x07, sp)
      00004E 20 BD            [ 2]  133 	jra	00109$
      000050                        134 00105$:
                                    135 ;	driver/modbus.c: 26: return ( crc);
      000050 1E 03            [ 2]  136 	ldw	x, (0x03, sp)
                                    137 ;	driver/modbus.c: 27: }
      000052 5B 08            [ 2]  138 	addw	sp, #8
      000054 81               [ 4]  139 	ret
                                    140 ;	driver/modbus.c: 28: void modbus_send(u8 cnt)
                                    141 ;	-----------------------------------------
                                    142 ;	 function modbus_send
                                    143 ;	-----------------------------------------
      000055                        144 _modbus_send:
      000055 88               [ 1]  145 	push	a
                                    146 ;	driver/modbus.c: 31: for(i=0;i<cnt;i++)
      000056 0F 01            [ 1]  147 	clr	(0x01, sp)
      000058                        148 00106$:
      000058 7B 01            [ 1]  149 	ld	a, (0x01, sp)
      00005A 11 04            [ 1]  150 	cp	a, (0x04, sp)
      00005C 24 1D            [ 1]  151 	jrnc	00108$
                                    152 ;	driver/modbus.c: 33: while(( UART2_GetFlagStatus(UART2_FLAG_TXE)==RESET));
      00005E                        153 00101$:
      00005E 4B 80            [ 1]  154 	push	#0x80
      000060 4B 00            [ 1]  155 	push	#0x00
      000062 CDr00r00         [ 4]  156 	call	_UART2_GetFlagStatus
      000065 5B 02            [ 2]  157 	addw	sp, #2
      000067 4D               [ 1]  158 	tnz	a
      000068 27 F4            [ 1]  159 	jreq	00101$
                                    160 ;	driver/modbus.c: 34: UART2_SendData8(modbus_buff[i]);
      00006A 5F               [ 1]  161 	clrw	x
      00006B 7B 01            [ 1]  162 	ld	a, (0x01, sp)
      00006D 97               [ 1]  163 	ld	xl, a
      00006E 1Cr00r00         [ 2]  164 	addw	x, #_modbus_buff
      000071 F6               [ 1]  165 	ld	a, (x)
      000072 88               [ 1]  166 	push	a
      000073 CDr00r00         [ 4]  167 	call	_UART2_SendData8
      000076 84               [ 1]  168 	pop	a
                                    169 ;	driver/modbus.c: 31: for(i=0;i<cnt;i++)
      000077 0C 01            [ 1]  170 	inc	(0x01, sp)
      000079 20 DD            [ 2]  171 	jra	00106$
      00007B                        172 00108$:
                                    173 ;	driver/modbus.c: 36: }
      00007B 84               [ 1]  174 	pop	a
      00007C 81               [ 4]  175 	ret
                                    176 ;	driver/modbus.c: 38: void modbus_virtual_write(u32 address,u8 data)//虚拟地址写
                                    177 ;	-----------------------------------------
                                    178 ;	 function modbus_virtual_write
                                    179 ;	-----------------------------------------
      00007D                        180 _modbus_virtual_write:
                                    181 ;	driver/modbus.c: 40: switch(address)
      00007D 1E 05            [ 2]  182 	ldw	x, (0x05, sp)
      00007F A3 04 06         [ 2]  183 	cpw	x, #0x0406
      000082 26 04            [ 1]  184 	jrne	00151$
      000084 1E 03            [ 2]  185 	ldw	x, (0x03, sp)
      000086 27 2D            [ 1]  186 	jreq	00101$
      000088                        187 00151$:
      000088 1E 05            [ 2]  188 	ldw	x, (0x05, sp)
      00008A A3 04 07         [ 2]  189 	cpw	x, #0x0407
      00008D 26 04            [ 1]  190 	jrne	00154$
      00008F 1E 03            [ 2]  191 	ldw	x, (0x03, sp)
      000091 27 32            [ 1]  192 	jreq	00102$
      000093                        193 00154$:
      000093 1E 05            [ 2]  194 	ldw	x, (0x05, sp)
      000095 A3 04 08         [ 2]  195 	cpw	x, #0x0408
      000098 26 04            [ 1]  196 	jrne	00157$
      00009A 1E 03            [ 2]  197 	ldw	x, (0x03, sp)
      00009C 27 37            [ 1]  198 	jreq	00103$
      00009E                        199 00157$:
      00009E 1E 05            [ 2]  200 	ldw	x, (0x05, sp)
      0000A0 A3 04 2E         [ 2]  201 	cpw	x, #0x042e
      0000A3 26 04            [ 1]  202 	jrne	00160$
      0000A5 1E 03            [ 2]  203 	ldw	x, (0x03, sp)
      0000A7 27 3C            [ 1]  204 	jreq	00104$
      0000A9                        205 00160$:
      0000A9 1E 05            [ 2]  206 	ldw	x, (0x05, sp)
      0000AB A3 04 38         [ 2]  207 	cpw	x, #0x0438
      0000AE 26 04            [ 1]  208 	jrne	00163$
      0000B0 1E 03            [ 2]  209 	ldw	x, (0x03, sp)
      0000B2 27 3B            [ 1]  210 	jreq	00108$
      0000B4                        211 00163$:
      0000B4 81               [ 4]  212 	ret
                                    213 ;	driver/modbus.c: 42: case 1030:
      0000B5                        214 00101$:
                                    215 ;	driver/modbus.c: 43: ds_time.hour=data;ds1302_write_time(&ds_time);break;
      0000B5 AEr00r04         [ 2]  216 	ldw	x, #_ds_time+4
      0000B8 7B 07            [ 1]  217 	ld	a, (0x07, sp)
      0000BA F7               [ 1]  218 	ld	(x), a
      0000BB 4Br00            [ 1]  219 	push	#<_ds_time
      0000BD 4Bs00            [ 1]  220 	push	#(_ds_time >> 8)
      0000BF CDr00r00         [ 4]  221 	call	_ds1302_write_time
      0000C2 5B 02            [ 2]  222 	addw	sp, #2
      0000C4 81               [ 4]  223 	ret
                                    224 ;	driver/modbus.c: 44: case 1031:
      0000C5                        225 00102$:
                                    226 ;	driver/modbus.c: 45: ds_time.minute=data;ds1302_write_time(&ds_time);break;
      0000C5 AEr00r05         [ 2]  227 	ldw	x, #_ds_time+5
      0000C8 7B 07            [ 1]  228 	ld	a, (0x07, sp)
      0000CA F7               [ 1]  229 	ld	(x), a
      0000CB 4Br00            [ 1]  230 	push	#<_ds_time
      0000CD 4Bs00            [ 1]  231 	push	#(_ds_time >> 8)
      0000CF CDr00r00         [ 4]  232 	call	_ds1302_write_time
      0000D2 5B 02            [ 2]  233 	addw	sp, #2
      0000D4 81               [ 4]  234 	ret
                                    235 ;	driver/modbus.c: 46: case 1032:
      0000D5                        236 00103$:
                                    237 ;	driver/modbus.c: 47: ds_time.second=data;ds1302_write_time(&ds_time);break;
      0000D5 AEr00r06         [ 2]  238 	ldw	x, #_ds_time+6
      0000D8 7B 07            [ 1]  239 	ld	a, (0x07, sp)
      0000DA F7               [ 1]  240 	ld	(x), a
      0000DB 4Br00            [ 1]  241 	push	#<_ds_time
      0000DD 4Bs00            [ 1]  242 	push	#(_ds_time >> 8)
      0000DF CDr00r00         [ 4]  243 	call	_ds1302_write_time
      0000E2 5B 02            [ 2]  244 	addw	sp, #2
      0000E4 81               [ 4]  245 	ret
                                    246 ;	driver/modbus.c: 48: case 1070:
      0000E5                        247 00104$:
                                    248 ;	driver/modbus.c: 49: if(data) beep_on(); else beep_off();break;
      0000E5 0D 07            [ 1]  249 	tnz	(0x07, sp)
      0000E7 27 03            [ 1]  250 	jreq	00106$
      0000E9 CCr00r00         [ 2]  251 	jp	_beep_on
      0000EC                        252 00106$:
      0000EC CCr00r00         [ 2]  253 	jp	_beep_off
                                    254 ;	driver/modbus.c: 50: case 1080:
      0000EF                        255 00108$:
                                    256 ;	driver/modbus.c: 51: if(data) relay_on(); else relay_off();break;
      0000EF 0D 07            [ 1]  257 	tnz	(0x07, sp)
      0000F1 27 03            [ 1]  258 	jreq	00110$
      0000F3 CCr00r00         [ 2]  259 	jp	_relay_on
      0000F6                        260 00110$:
                                    261 ;	driver/modbus.c: 52: }
                                    262 ;	driver/modbus.c: 53: }
      0000F6 CCr00r00         [ 2]  263 	jp	_relay_off
                                    264 ;	driver/modbus.c: 54: void modbus_virtual_read(u32 address)//虚拟地址读取
                                    265 ;	-----------------------------------------
                                    266 ;	 function modbus_virtual_read
                                    267 ;	-----------------------------------------
      0000F9                        268 _modbus_virtual_read:
                                    269 ;	driver/modbus.c: 56: switch(address)
      0000F9 1E 05            [ 2]  270 	ldw	x, (0x05, sp)
      0000FB A3 04 06         [ 2]  271 	cpw	x, #0x0406
      0000FE 26 07            [ 1]  272 	jrne	00213$
      000100 1E 03            [ 2]  273 	ldw	x, (0x03, sp)
      000102 26 03            [ 1]  274 	jrne	00213$
      000104 CCr01rF6         [ 2]  275 	jp	00101$
      000107                        276 00213$:
      000107 1E 05            [ 2]  277 	ldw	x, (0x05, sp)
      000109 A3 04 07         [ 2]  278 	cpw	x, #0x0407
      00010C 26 07            [ 1]  279 	jrne	00216$
      00010E 1E 03            [ 2]  280 	ldw	x, (0x03, sp)
      000110 26 03            [ 1]  281 	jrne	00216$
      000112 CCr02r01         [ 2]  282 	jp	00102$
      000115                        283 00216$:
      000115 1E 05            [ 2]  284 	ldw	x, (0x05, sp)
      000117 A3 04 08         [ 2]  285 	cpw	x, #0x0408
      00011A 26 07            [ 1]  286 	jrne	00219$
      00011C 1E 03            [ 2]  287 	ldw	x, (0x03, sp)
      00011E 26 03            [ 1]  288 	jrne	00219$
      000120 CCr02r0C         [ 2]  289 	jp	00103$
      000123                        290 00219$:
      000123 1E 05            [ 2]  291 	ldw	x, (0x05, sp)
      000125 A3 04 10         [ 2]  292 	cpw	x, #0x0410
      000128 26 07            [ 1]  293 	jrne	00222$
      00012A 1E 03            [ 2]  294 	ldw	x, (0x03, sp)
      00012C 26 03            [ 1]  295 	jrne	00222$
      00012E CCr02r17         [ 2]  296 	jp	00104$
      000131                        297 00222$:
      000131 1E 05            [ 2]  298 	ldw	x, (0x05, sp)
      000133 A3 04 11         [ 2]  299 	cpw	x, #0x0411
      000136 26 07            [ 1]  300 	jrne	00225$
      000138 1E 03            [ 2]  301 	ldw	x, (0x03, sp)
      00013A 26 03            [ 1]  302 	jrne	00225$
      00013C CCr02r22         [ 2]  303 	jp	00105$
      00013F                        304 00225$:
      00013F 1E 05            [ 2]  305 	ldw	x, (0x05, sp)
      000141 A3 04 12         [ 2]  306 	cpw	x, #0x0412
      000144 26 07            [ 1]  307 	jrne	00228$
      000146 1E 03            [ 2]  308 	ldw	x, (0x03, sp)
      000148 26 03            [ 1]  309 	jrne	00228$
      00014A CCr02r2A         [ 2]  310 	jp	00106$
      00014D                        311 00228$:
      00014D 1E 05            [ 2]  312 	ldw	x, (0x05, sp)
      00014F A3 04 1A         [ 2]  313 	cpw	x, #0x041a
      000152 26 07            [ 1]  314 	jrne	00231$
      000154 1E 03            [ 2]  315 	ldw	x, (0x03, sp)
      000156 26 03            [ 1]  316 	jrne	00231$
      000158 CCr02r35         [ 2]  317 	jp	00107$
      00015B                        318 00231$:
      00015B 1E 05            [ 2]  319 	ldw	x, (0x05, sp)
      00015D A3 04 1B         [ 2]  320 	cpw	x, #0x041b
      000160 26 07            [ 1]  321 	jrne	00234$
      000162 1E 03            [ 2]  322 	ldw	x, (0x03, sp)
      000164 26 03            [ 1]  323 	jrne	00234$
      000166 CCr02r40         [ 2]  324 	jp	00108$
      000169                        325 00234$:
      000169 1E 05            [ 2]  326 	ldw	x, (0x05, sp)
      00016B A3 04 1C         [ 2]  327 	cpw	x, #0x041c
      00016E 26 07            [ 1]  328 	jrne	00237$
      000170 1E 03            [ 2]  329 	ldw	x, (0x03, sp)
      000172 26 03            [ 1]  330 	jrne	00237$
      000174 CCr02r4B         [ 2]  331 	jp	00109$
      000177                        332 00237$:
      000177 1E 05            [ 2]  333 	ldw	x, (0x05, sp)
      000179 A3 04 1D         [ 2]  334 	cpw	x, #0x041d
      00017C 26 07            [ 1]  335 	jrne	00240$
      00017E 1E 03            [ 2]  336 	ldw	x, (0x03, sp)
      000180 26 03            [ 1]  337 	jrne	00240$
      000182 CCr02r53         [ 2]  338 	jp	00110$
      000185                        339 00240$:
      000185 1E 05            [ 2]  340 	ldw	x, (0x05, sp)
      000187 A3 04 1E         [ 2]  341 	cpw	x, #0x041e
      00018A 26 07            [ 1]  342 	jrne	00243$
      00018C 1E 03            [ 2]  343 	ldw	x, (0x03, sp)
      00018E 26 03            [ 1]  344 	jrne	00243$
      000190 CCr02r5E         [ 2]  345 	jp	00111$
      000193                        346 00243$:
      000193 1E 05            [ 2]  347 	ldw	x, (0x05, sp)
      000195 A3 04 24         [ 2]  348 	cpw	x, #0x0424
      000198 26 07            [ 1]  349 	jrne	00246$
      00019A 1E 03            [ 2]  350 	ldw	x, (0x03, sp)
      00019C 26 03            [ 1]  351 	jrne	00246$
      00019E CCr02r69         [ 2]  352 	jp	00112$
      0001A1                        353 00246$:
      0001A1 1E 05            [ 2]  354 	ldw	x, (0x05, sp)
      0001A3 A3 04 25         [ 2]  355 	cpw	x, #0x0425
      0001A6 26 07            [ 1]  356 	jrne	00249$
      0001A8 1E 03            [ 2]  357 	ldw	x, (0x03, sp)
      0001AA 26 03            [ 1]  358 	jrne	00249$
      0001AC CCr02r71         [ 2]  359 	jp	00113$
      0001AF                        360 00249$:
      0001AF 1E 05            [ 2]  361 	ldw	x, (0x05, sp)
      0001B1 A3 04 26         [ 2]  362 	cpw	x, #0x0426
      0001B4 26 07            [ 1]  363 	jrne	00252$
      0001B6 1E 03            [ 2]  364 	ldw	x, (0x03, sp)
      0001B8 26 03            [ 1]  365 	jrne	00252$
      0001BA CCr02r7C         [ 2]  366 	jp	00114$
      0001BD                        367 00252$:
      0001BD 1E 05            [ 2]  368 	ldw	x, (0x05, sp)
      0001BF A3 04 27         [ 2]  369 	cpw	x, #0x0427
      0001C2 26 07            [ 1]  370 	jrne	00255$
      0001C4 1E 03            [ 2]  371 	ldw	x, (0x03, sp)
      0001C6 26 03            [ 1]  372 	jrne	00255$
      0001C8 CCr02r87         [ 2]  373 	jp	00115$
      0001CB                        374 00255$:
      0001CB 1E 05            [ 2]  375 	ldw	x, (0x05, sp)
      0001CD A3 04 28         [ 2]  376 	cpw	x, #0x0428
      0001D0 26 07            [ 1]  377 	jrne	00258$
      0001D2 1E 03            [ 2]  378 	ldw	x, (0x03, sp)
      0001D4 26 03            [ 1]  379 	jrne	00258$
      0001D6 CCr02r92         [ 2]  380 	jp	00116$
      0001D9                        381 00258$:
      0001D9 1E 05            [ 2]  382 	ldw	x, (0x05, sp)
      0001DB A3 04 2E         [ 2]  383 	cpw	x, #0x042e
      0001DE 26 07            [ 1]  384 	jrne	00261$
      0001E0 1E 03            [ 2]  385 	ldw	x, (0x03, sp)
      0001E2 26 03            [ 1]  386 	jrne	00261$
      0001E4 CCr02r9D         [ 2]  387 	jp	00117$
      0001E7                        388 00261$:
      0001E7 1E 05            [ 2]  389 	ldw	x, (0x05, sp)
      0001E9 A3 04 38         [ 2]  390 	cpw	x, #0x0438
      0001EC 26 07            [ 1]  391 	jrne	00264$
      0001EE 1E 03            [ 2]  392 	ldw	x, (0x03, sp)
      0001F0 26 03            [ 1]  393 	jrne	00264$
      0001F2 CCr02rA7         [ 2]  394 	jp	00118$
      0001F5                        395 00264$:
      0001F5 81               [ 4]  396 	ret
                                    397 ;	driver/modbus.c: 58: case 1030:
      0001F6                        398 00101$:
                                    399 ;	driver/modbus.c: 59: modbus_buff[4]=ds_time.hour;break;
      0001F6 AEr00r04         [ 2]  400 	ldw	x, #_modbus_buff+4
      0001F9 90 AEr00r04      [ 2]  401 	ldw	y, #_ds_time+4
      0001FD 90 F6            [ 1]  402 	ld	a, (y)
      0001FF F7               [ 1]  403 	ld	(x), a
      000200 81               [ 4]  404 	ret
                                    405 ;	driver/modbus.c: 60: case 1031:
      000201                        406 00102$:
                                    407 ;	driver/modbus.c: 61: modbus_buff[4]=ds_time.minute;break;
      000201 AEr00r04         [ 2]  408 	ldw	x, #_modbus_buff+4
      000204 90 AEr00r05      [ 2]  409 	ldw	y, #_ds_time+5
      000208 90 F6            [ 1]  410 	ld	a, (y)
      00020A F7               [ 1]  411 	ld	(x), a
      00020B 81               [ 4]  412 	ret
                                    413 ;	driver/modbus.c: 62: case 1032:
      00020C                        414 00103$:
                                    415 ;	driver/modbus.c: 63: modbus_buff[4]=ds_time.second;break;
      00020C AEr00r04         [ 2]  416 	ldw	x, #_modbus_buff+4
      00020F 90 AEr00r06      [ 2]  417 	ldw	y, #_ds_time+6
      000213 90 F6            [ 1]  418 	ld	a, (y)
      000215 F7               [ 1]  419 	ld	(x), a
      000216 81               [ 4]  420 	ret
                                    421 ;	driver/modbus.c: 64: case 1040:
      000217                        422 00104$:
                                    423 ;	driver/modbus.c: 65: modbus_buff[4]=(adc_data.Ain&0xff00)>>8;break;
      000217 AEr00r04         [ 2]  424 	ldw	x, #_modbus_buff+4
      00021A 90 CEu00u00      [ 2]  425 	ldw	y, _adc_data
      00021E 90 9E            [ 1]  426 	ld	a, yh
      000220 F7               [ 1]  427 	ld	(x), a
      000221 81               [ 4]  428 	ret
                                    429 ;	driver/modbus.c: 66: case 1041:
      000222                        430 00105$:
                                    431 ;	driver/modbus.c: 67: modbus_buff[4]=adc_data.Ain&0xff;break;
      000222 AEr00r04         [ 2]  432 	ldw	x, #_modbus_buff+4
      000225 C6u00u01         [ 1]  433 	ld	a, _adc_data+1
      000228 F7               [ 1]  434 	ld	(x), a
      000229 81               [ 4]  435 	ret
                                    436 ;	driver/modbus.c: 68: case 1042:
      00022A                        437 00106$:
                                    438 ;	driver/modbus.c: 69: modbus_buff[4]=adc_data.Din;break;
      00022A AEr00r04         [ 2]  439 	ldw	x, #_modbus_buff+4
      00022D 90 AEr00r02      [ 2]  440 	ldw	y, #_adc_data+2
      000231 90 F6            [ 1]  441 	ld	a, (y)
      000233 F7               [ 1]  442 	ld	(x), a
      000234 81               [ 4]  443 	ret
                                    444 ;	driver/modbus.c: 70: case 1050:
      000235                        445 00107$:
                                    446 ;	driver/modbus.c: 71: modbus_buff[4]=dh_data.W;break;
      000235 AEr00r04         [ 2]  447 	ldw	x, #_modbus_buff+4
      000238 90 AEr00r02      [ 2]  448 	ldw	y, #_dh_data+2
      00023C 90 F6            [ 1]  449 	ld	a, (y)
      00023E F7               [ 1]  450 	ld	(x), a
      00023F 81               [ 4]  451 	ret
                                    452 ;	driver/modbus.c: 72: case 1051:
      000240                        453 00108$:
                                    454 ;	driver/modbus.c: 73: modbus_buff[4]=dh_data.W1;break;
      000240 AEr00r04         [ 2]  455 	ldw	x, #_modbus_buff+4
      000243 90 AEr00r03      [ 2]  456 	ldw	y, #_dh_data+3
      000247 90 F6            [ 1]  457 	ld	a, (y)
      000249 F7               [ 1]  458 	ld	(x), a
      00024A 81               [ 4]  459 	ret
                                    460 ;	driver/modbus.c: 74: case 1052:
      00024B                        461 00109$:
                                    462 ;	driver/modbus.c: 75: modbus_buff[4]=dh_data.T;break;
      00024B AEr00r04         [ 2]  463 	ldw	x, #_modbus_buff+4
      00024E C6u00u00         [ 1]  464 	ld	a, _dh_data
      000251 F7               [ 1]  465 	ld	(x), a
      000252 81               [ 4]  466 	ret
                                    467 ;	driver/modbus.c: 76: case 1053:
      000253                        468 00110$:
                                    469 ;	driver/modbus.c: 77: modbus_buff[4]=dh_data.T1;break;
      000253 AEr00r04         [ 2]  470 	ldw	x, #_modbus_buff+4
      000256 90 AEr00r01      [ 2]  471 	ldw	y, #_dh_data+1
      00025A 90 F6            [ 1]  472 	ld	a, (y)
      00025C F7               [ 1]  473 	ld	(x), a
      00025D 81               [ 4]  474 	ret
                                    475 ;	driver/modbus.c: 78: case 1054:
      00025E                        476 00111$:
                                    477 ;	driver/modbus.c: 79: modbus_buff[4]=dh_data.sum;break;
      00025E AEr00r04         [ 2]  478 	ldw	x, #_modbus_buff+4
      000261 90 AEr00r04      [ 2]  479 	ldw	y, #_dh_data+4
      000265 90 F6            [ 1]  480 	ld	a, (y)
      000267 F7               [ 1]  481 	ld	(x), a
      000268 81               [ 4]  482 	ret
                                    483 ;	driver/modbus.c: 80: case 1060:
      000269                        484 00112$:
                                    485 ;	driver/modbus.c: 81: modbus_buff[4]=keycount[0];break;
      000269 AEr00r04         [ 2]  486 	ldw	x, #_modbus_buff+4
      00026C C6u00u00         [ 1]  487 	ld	a, _keycount
      00026F F7               [ 1]  488 	ld	(x), a
      000270 81               [ 4]  489 	ret
                                    490 ;	driver/modbus.c: 82: case 1061:
      000271                        491 00113$:
                                    492 ;	driver/modbus.c: 83: modbus_buff[4]=keycount[1];break;
      000271 AEr00r04         [ 2]  493 	ldw	x, #_modbus_buff+4
      000274 90 AEr00r01      [ 2]  494 	ldw	y, #_keycount+1
      000278 90 F6            [ 1]  495 	ld	a, (y)
      00027A F7               [ 1]  496 	ld	(x), a
      00027B 81               [ 4]  497 	ret
                                    498 ;	driver/modbus.c: 84: case 1062:
      00027C                        499 00114$:
                                    500 ;	driver/modbus.c: 85: modbus_buff[4]=keycount[2];break;
      00027C AEr00r04         [ 2]  501 	ldw	x, #_modbus_buff+4
      00027F 90 AEr00r02      [ 2]  502 	ldw	y, #_keycount+2
      000283 90 F6            [ 1]  503 	ld	a, (y)
      000285 F7               [ 1]  504 	ld	(x), a
      000286 81               [ 4]  505 	ret
                                    506 ;	driver/modbus.c: 86: case 1063:
      000287                        507 00115$:
                                    508 ;	driver/modbus.c: 87: modbus_buff[4]=keycount[3];break;
      000287 AEr00r04         [ 2]  509 	ldw	x, #_modbus_buff+4
      00028A 90 AEr00r03      [ 2]  510 	ldw	y, #_keycount+3
      00028E 90 F6            [ 1]  511 	ld	a, (y)
      000290 F7               [ 1]  512 	ld	(x), a
      000291 81               [ 4]  513 	ret
                                    514 ;	driver/modbus.c: 88: case 1064:
      000292                        515 00116$:
                                    516 ;	driver/modbus.c: 89: modbus_buff[4]=keycount[4];break;
      000292 AEr00r04         [ 2]  517 	ldw	x, #_modbus_buff+4
      000295 90 AEr00r04      [ 2]  518 	ldw	y, #_keycount+4
      000299 90 F6            [ 1]  519 	ld	a, (y)
      00029B F7               [ 1]  520 	ld	(x), a
      00029C 81               [ 4]  521 	ret
                                    522 ;	driver/modbus.c: 90: case 1070:
      00029D                        523 00117$:
                                    524 ;	driver/modbus.c: 91: modbus_buff[4]=beep_read();break;
      00029D AEr00r04         [ 2]  525 	ldw	x, #_modbus_buff+4
      0002A0 89               [ 2]  526 	pushw	x
      0002A1 CDr00r00         [ 4]  527 	call	_beep_read
      0002A4 85               [ 2]  528 	popw	x
      0002A5 F7               [ 1]  529 	ld	(x), a
      0002A6 81               [ 4]  530 	ret
                                    531 ;	driver/modbus.c: 92: case 1080:
      0002A7                        532 00118$:
                                    533 ;	driver/modbus.c: 93: modbus_buff[4]=relay_read();break;
      0002A7 AEr00r04         [ 2]  534 	ldw	x, #_modbus_buff+4
      0002AA 89               [ 2]  535 	pushw	x
      0002AB CDr00r00         [ 4]  536 	call	_relay_read
      0002AE 85               [ 2]  537 	popw	x
      0002AF F7               [ 1]  538 	ld	(x), a
                                    539 ;	driver/modbus.c: 95: }
                                    540 ;	driver/modbus.c: 97: }
      0002B0 81               [ 4]  541 	ret
                                    542 ;	driver/modbus.c: 99: void modbus_process()
                                    543 ;	-----------------------------------------
                                    544 ;	 function modbus_process
                                    545 ;	-----------------------------------------
      0002B1                        546 _modbus_process:
      0002B1 52 40            [ 2]  547 	sub	sp, #64
                                    548 ;	driver/modbus.c: 104: if(CRC16(modbus_buff,6)!=(((u16)modbus_buff[6])+(u16)(modbus_buff[7])*256))
      0002B3 4B 06            [ 1]  549 	push	#0x06
      0002B5 4Br00            [ 1]  550 	push	#<_modbus_buff
      0002B7 4Bs00            [ 1]  551 	push	#(_modbus_buff >> 8)
      0002B9 CDr00r00         [ 4]  552 	call	_CRC16
      0002BC 5B 03            [ 2]  553 	addw	sp, #3
      0002BE 1F 19            [ 2]  554 	ldw	(0x19, sp), x
      0002C0 AEr00r06         [ 2]  555 	ldw	x, #_modbus_buff+6
      0002C3 1F 1D            [ 2]  556 	ldw	(0x1d, sp), x
      0002C5 F6               [ 1]  557 	ld	a, (x)
      0002C6 6B 1C            [ 1]  558 	ld	(0x1c, sp), a
      0002C8 0F 1B            [ 1]  559 	clr	(0x1b, sp)
      0002CA AEr00r07         [ 2]  560 	ldw	x, #_modbus_buff+7
      0002CD 1F 10            [ 2]  561 	ldw	(0x10, sp), x
      0002CF F6               [ 1]  562 	ld	a, (x)
      0002D0 97               [ 1]  563 	ld	xl, a
      0002D1 4F               [ 1]  564 	clr	a
      0002D2 02               [ 1]  565 	rlwa	x
      0002D3 72 FB 1B         [ 2]  566 	addw	x, (0x1b, sp)
      0002D6 1F 0E            [ 2]  567 	ldw	(0x0e, sp), x
      0002D8 1E 19            [ 2]  568 	ldw	x, (0x19, sp)
      0002DA 13 0E            [ 2]  569 	cpw	x, (0x0e, sp)
      0002DC 27 03            [ 1]  570 	jreq	00102$
                                    571 ;	driver/modbus.c: 105: return;
      0002DE CCr04r83         [ 2]  572 	jp	00119$
      0002E1                        573 00102$:
                                    574 ;	driver/modbus.c: 108: if(modbus_buff[0]==0)//从站地址为0时仅支持06代码（单寄存器）
      0002E1 C6u00u00         [ 1]  575 	ld	a, _modbus_buff
      0002E4 6B 21            [ 1]  576 	ld	(0x21, sp), a
                                    577 ;	driver/modbus.c: 110: if(modbus_buff[1]==06)// 写单个寄存器（8位）
      0002E6 AEr00r01         [ 2]  578 	ldw	x, #_modbus_buff+1
      0002E9 1F 1F            [ 2]  579 	ldw	(0x1f, sp), x
                                    580 ;	driver/modbus.c: 113: address=(u32)modbus_buff[3]+modbus_buff[2]*256;
      0002EB AEr00r03         [ 2]  581 	ldw	x, #_modbus_buff+3
      0002EE 1F 24            [ 2]  582 	ldw	(0x24, sp), x
      0002F0 AEr00r02         [ 2]  583 	ldw	x, #_modbus_buff+2
      0002F3 1F 22            [ 2]  584 	ldw	(0x22, sp), x
                                    585 ;	driver/modbus.c: 114: if(address <1024) eeprom_write(address,modbus_buff[5]);
      0002F5 AEr00r05         [ 2]  586 	ldw	x, #_modbus_buff+5
      0002F8 1F 0C            [ 2]  587 	ldw	(0x0c, sp), x
                                    588 ;	driver/modbus.c: 108: if(modbus_buff[0]==0)//从站地址为0时仅支持06代码（单寄存器）
      0002FA 0D 21            [ 1]  589 	tnz	(0x21, sp)
      0002FC 26 73            [ 1]  590 	jrne	00108$
                                    591 ;	driver/modbus.c: 110: if(modbus_buff[1]==06)// 写单个寄存器（8位）
      0002FE 1E 1F            [ 2]  592 	ldw	x, (0x1f, sp)
      000300 F6               [ 1]  593 	ld	a, (x)
      000301 A1 06            [ 1]  594 	cp	a, #0x06
      000303 27 03            [ 1]  595 	jreq	00172$
      000305 CCr04r83         [ 2]  596 	jp	00119$
      000308                        597 00172$:
                                    598 ;	driver/modbus.c: 113: address=(u32)modbus_buff[3]+modbus_buff[2]*256;
      000308 1E 24            [ 2]  599 	ldw	x, (0x24, sp)
      00030A F6               [ 1]  600 	ld	a, (x)
      00030B 6B 0B            [ 1]  601 	ld	(0x0b, sp), a
      00030D 7B 0B            [ 1]  602 	ld	a, (0x0b, sp)
      00030F 6B 18            [ 1]  603 	ld	(0x18, sp), a
      000311 0F 17            [ 1]  604 	clr	(0x17, sp)
      000313 0F 16            [ 1]  605 	clr	(0x16, sp)
      000315 0F 15            [ 1]  606 	clr	(0x15, sp)
      000317 1E 22            [ 2]  607 	ldw	x, (0x22, sp)
      000319 F6               [ 1]  608 	ld	a, (x)
      00031A 6B 14            [ 1]  609 	ld	(0x14, sp), a
      00031C 7B 14            [ 1]  610 	ld	a, (0x14, sp)
      00031E 6B 13            [ 1]  611 	ld	(0x13, sp), a
      000320 0F 12            [ 1]  612 	clr	(0x12, sp)
      000322 7B 13            [ 1]  613 	ld	a, (0x13, sp)
      000324 6B 33            [ 1]  614 	ld	(0x33, sp), a
      000326 0F 34            [ 1]  615 	clr	(0x34, sp)
      000328 16 33            [ 2]  616 	ldw	y, (0x33, sp)
      00032A 17 31            [ 2]  617 	ldw	(0x31, sp), y
      00032C 7B 31            [ 1]  618 	ld	a, (0x31, sp)
      00032E 49               [ 1]  619 	rlc	a
      00032F 4F               [ 1]  620 	clr	a
      000330 A2 00            [ 1]  621 	sbc	a, #0x00
      000332 6B 30            [ 1]  622 	ld	(0x30, sp), a
      000334 6B 2F            [ 1]  623 	ld	(0x2f, sp), a
      000336 1E 17            [ 2]  624 	ldw	x, (0x17, sp)
      000338 72 FB 31         [ 2]  625 	addw	x, (0x31, sp)
      00033B 1F 3B            [ 2]  626 	ldw	(0x3b, sp), x
      00033D 7B 16            [ 1]  627 	ld	a, (0x16, sp)
      00033F 19 30            [ 1]  628 	adc	a, (0x30, sp)
      000341 6B 3A            [ 1]  629 	ld	(0x3a, sp), a
      000343 7B 15            [ 1]  630 	ld	a, (0x15, sp)
      000345 19 2F            [ 1]  631 	adc	a, (0x2f, sp)
      000347 6B 39            [ 1]  632 	ld	(0x39, sp), a
      000349 16 3A            [ 2]  633 	ldw	y, (0x3a, sp)
      00034B 17 3A            [ 2]  634 	ldw	(0x3a, sp), y
                                    635 ;	driver/modbus.c: 114: if(address <1024) eeprom_write(address,modbus_buff[5]);
      00034D 1E 3B            [ 2]  636 	ldw	x, (0x3b, sp)
      00034F A3 04 00         [ 2]  637 	cpw	x, #0x0400
      000352 7B 3A            [ 1]  638 	ld	a, (0x3a, sp)
      000354 A2 00            [ 1]  639 	sbc	a, #0x00
      000356 7B 39            [ 1]  640 	ld	a, (0x39, sp)
      000358 A2 00            [ 1]  641 	sbc	a, #0x00
      00035A 25 03            [ 1]  642 	jrc	00173$
      00035C CCr04r83         [ 2]  643 	jp	00119$
      00035F                        644 00173$:
      00035F 1E 0C            [ 2]  645 	ldw	x, (0x0c, sp)
      000361 F6               [ 1]  646 	ld	a, (x)
      000362 88               [ 1]  647 	push	a
      000363 1E 3C            [ 2]  648 	ldw	x, (0x3c, sp)
      000365 89               [ 2]  649 	pushw	x
      000366 1E 3C            [ 2]  650 	ldw	x, (0x3c, sp)
      000368 89               [ 2]  651 	pushw	x
      000369 CDr00r00         [ 4]  652 	call	_eeprom_write
      00036C 5B 05            [ 2]  653 	addw	sp, #5
                                    654 ;	driver/modbus.c: 116: return;
      00036E CCr04r83         [ 2]  655 	jp	00119$
      000371                        656 00108$:
                                    657 ;	driver/modbus.c: 119: if(modbus_buff[0]==eeprom_read(0)) //当地址为本机地址时
      000371 5F               [ 1]  658 	clrw	x
      000372 89               [ 2]  659 	pushw	x
      000373 5F               [ 1]  660 	clrw	x
      000374 89               [ 2]  661 	pushw	x
      000375 CDr00r00         [ 4]  662 	call	_eeprom_read
      000378 5B 04            [ 2]  663 	addw	sp, #4
      00037A 6B 2E            [ 1]  664 	ld	(0x2e, sp), a
      00037C 7B 21            [ 1]  665 	ld	a, (0x21, sp)
      00037E 11 2E            [ 1]  666 	cp	a, (0x2e, sp)
      000380 27 03            [ 1]  667 	jreq	00176$
      000382 CCr04r83         [ 2]  668 	jp	00119$
      000385                        669 00176$:
                                    670 ;	driver/modbus.c: 121: if(modbus_buff[1]==06) // 写单个寄存器
      000385 1E 1F            [ 2]  671 	ldw	x, (0x1f, sp)
      000387 F6               [ 1]  672 	ld	a, (x)
      000388 A1 06            [ 1]  673 	cp	a, #0x06
      00038A 26 70            [ 1]  674 	jrne	00112$
                                    675 ;	driver/modbus.c: 124: address=(u32)modbus_buff[3]+modbus_buff[2]*256;
      00038C 1E 24            [ 2]  676 	ldw	x, (0x24, sp)
      00038E F6               [ 1]  677 	ld	a, (x)
      00038F 6B 2D            [ 1]  678 	ld	(0x2d, sp), a
      000391 0F 2C            [ 1]  679 	clr	(0x2c, sp)
      000393 90 5F            [ 1]  680 	clrw	y
      000395 1E 22            [ 2]  681 	ldw	x, (0x22, sp)
      000397 F6               [ 1]  682 	ld	a, (x)
      000398 95               [ 1]  683 	ld	xh, a
      000399 4F               [ 1]  684 	clr	a
      00039A 97               [ 1]  685 	ld	xl, a
      00039B 9E               [ 1]  686 	ld	a, xh
      00039C 49               [ 1]  687 	rlc	a
      00039D 4F               [ 1]  688 	clr	a
      00039E A2 00            [ 1]  689 	sbc	a, #0x00
      0003A0 6B 27            [ 1]  690 	ld	(0x27, sp), a
      0003A2 6B 26            [ 1]  691 	ld	(0x26, sp), a
      0003A4 72 FB 2C         [ 2]  692 	addw	x, (0x2c, sp)
      0003A7 90 9F            [ 1]  693 	ld	a, yl
      0003A9 19 27            [ 1]  694 	adc	a, (0x27, sp)
      0003AB 90 02            [ 1]  695 	rlwa	y
      0003AD 19 26            [ 1]  696 	adc	a, (0x26, sp)
      0003AF 1F 37            [ 2]  697 	ldw	(0x37, sp), x
      0003B1 90 95            [ 1]  698 	ld	yh, a
                                    699 ;	driver/modbus.c: 125: if(address <1024) eeprom_write(address,modbus_buff[5]);
      0003B3 1E 37            [ 2]  700 	ldw	x, (0x37, sp)
      0003B5 A3 04 00         [ 2]  701 	cpw	x, #0x0400
      0003B8 90 9F            [ 1]  702 	ld	a, yl
      0003BA A2 00            [ 1]  703 	sbc	a, #0x00
      0003BC 90 9E            [ 1]  704 	ld	a, yh
      0003BE A2 00            [ 1]  705 	sbc	a, #0x00
      0003C0 24 12            [ 1]  706 	jrnc	00110$
      0003C2 1E 0C            [ 2]  707 	ldw	x, (0x0c, sp)
      0003C4 F6               [ 1]  708 	ld	a, (x)
      0003C5 90 89            [ 2]  709 	pushw	y
      0003C7 88               [ 1]  710 	push	a
      0003C8 1E 3A            [ 2]  711 	ldw	x, (0x3a, sp)
      0003CA 89               [ 2]  712 	pushw	x
      0003CB 90 89            [ 2]  713 	pushw	y
      0003CD CDr00r00         [ 4]  714 	call	_eeprom_write
      0003D0 5B 05            [ 2]  715 	addw	sp, #5
      0003D2 90 85            [ 2]  716 	popw	y
      0003D4                        717 00110$:
                                    718 ;	driver/modbus.c: 126: modbus_virtual_write(address,modbus_buff[5]);
      0003D4 1E 0C            [ 2]  719 	ldw	x, (0x0c, sp)
      0003D6 F6               [ 1]  720 	ld	a, (x)
      0003D7 88               [ 1]  721 	push	a
      0003D8 1E 38            [ 2]  722 	ldw	x, (0x38, sp)
      0003DA 89               [ 2]  723 	pushw	x
      0003DB 90 89            [ 2]  724 	pushw	y
      0003DD CDr00r7D         [ 4]  725 	call	_modbus_virtual_write
      0003E0 5B 05            [ 2]  726 	addw	sp, #5
                                    727 ;	driver/modbus.c: 128: u16 crc=CRC16(modbus_buff,6);
      0003E2 4B 06            [ 1]  728 	push	#0x06
      0003E4 4Br00            [ 1]  729 	push	#<_modbus_buff
      0003E6 4Bs00            [ 1]  730 	push	#(_modbus_buff >> 8)
      0003E8 CDr00r00         [ 4]  731 	call	_CRC16
      0003EB 5B 03            [ 2]  732 	addw	sp, #3
                                    733 ;	driver/modbus.c: 129: modbus_buff[6]=crc&0xff;
      0003ED 9F               [ 1]  734 	ld	a, xl
      0003EE 16 1D            [ 2]  735 	ldw	y, (0x1d, sp)
      0003F0 90 F7            [ 1]  736 	ld	(y), a
                                    737 ;	driver/modbus.c: 130: modbus_buff[7]=crc>>8;
      0003F2 9E               [ 1]  738 	ld	a, xh
      0003F3 1E 10            [ 2]  739 	ldw	x, (0x10, sp)
      0003F5 F7               [ 1]  740 	ld	(x), a
                                    741 ;	driver/modbus.c: 133: modbus_send(8);
      0003F6 4B 08            [ 1]  742 	push	#0x08
      0003F8 CDr00r55         [ 4]  743 	call	_modbus_send
      0003FB 84               [ 1]  744 	pop	a
      0003FC                        745 00112$:
                                    746 ;	driver/modbus.c: 137: if(modbus_buff[1]==03) // 读单个寄存器
      0003FC 1E 1F            [ 2]  747 	ldw	x, (0x1f, sp)
      0003FE F6               [ 1]  748 	ld	a, (x)
      0003FF A1 03            [ 1]  749 	cp	a, #0x03
      000401 27 03            [ 1]  750 	jreq	00183$
      000403 CCr04r83         [ 2]  751 	jp	00119$
      000406                        752 00183$:
                                    753 ;	driver/modbus.c: 140: address=(u32)modbus_buff[3]+modbus_buff[2]*256;
      000406 1E 24            [ 2]  754 	ldw	x, (0x24, sp)
      000408 F6               [ 1]  755 	ld	a, (x)
      000409 6B 0A            [ 1]  756 	ld	(0x0a, sp), a
      00040B 0F 09            [ 1]  757 	clr	(0x09, sp)
      00040D 0F 08            [ 1]  758 	clr	(0x08, sp)
      00040F 0F 07            [ 1]  759 	clr	(0x07, sp)
      000411 1E 22            [ 2]  760 	ldw	x, (0x22, sp)
      000413 F6               [ 1]  761 	ld	a, (x)
      000414 97               [ 1]  762 	ld	xl, a
      000415 4F               [ 1]  763 	clr	a
      000416 02               [ 1]  764 	rlwa	x
      000417 9E               [ 1]  765 	ld	a, xh
      000418 49               [ 1]  766 	rlc	a
      000419 4F               [ 1]  767 	clr	a
      00041A A2 00            [ 1]  768 	sbc	a, #0x00
      00041C 88               [ 1]  769 	push	a
      00041D 6B 04            [ 1]  770 	ld	(0x04, sp), a
      00041F 84               [ 1]  771 	pop	a
      000420 72 FB 09         [ 2]  772 	addw	x, (0x09, sp)
      000423 19 08            [ 1]  773 	adc	a, (0x08, sp)
      000425 90 97            [ 1]  774 	ld	yl, a
      000427 7B 03            [ 1]  775 	ld	a, (0x03, sp)
      000429 19 07            [ 1]  776 	adc	a, (0x07, sp)
      00042B 90 95            [ 1]  777 	ld	yh, a
      00042D 17 3D            [ 2]  778 	ldw	(0x3d, sp), y
                                    779 ;	driver/modbus.c: 141: if(address <1024) {
      00042F A3 04 00         [ 2]  780 	cpw	x, #0x0400
      000432 7B 3E            [ 1]  781 	ld	a, (0x3e, sp)
      000434 A2 00            [ 1]  782 	sbc	a, #0x00
      000436 7B 3D            [ 1]  783 	ld	a, (0x3d, sp)
      000438 A2 00            [ 1]  784 	sbc	a, #0x00
      00043A 24 1C            [ 1]  785 	jrnc	00114$
                                    786 ;	driver/modbus.c: 142: modbus_buff[4]=eeprom_read(address);
      00043C A6r00            [ 1]  787 	ld	a, #<_modbus_buff
      00043E AB 04            [ 1]  788 	add	a, #0x04
      000440 6B 02            [ 1]  789 	ld	(0x02, sp), a
      000442 A6s00            [ 1]  790 	ld	a, #(_modbus_buff >> 8)
      000444 A9 00            [ 1]  791 	adc	a, #0x00
      000446 6B 01            [ 1]  792 	ld	(0x01, sp), a
      000448 89               [ 2]  793 	pushw	x
      000449 89               [ 2]  794 	pushw	x
      00044A 16 41            [ 2]  795 	ldw	y, (0x41, sp)
      00044C 90 89            [ 2]  796 	pushw	y
      00044E CDr00r00         [ 4]  797 	call	_eeprom_read
      000451 5B 04            [ 2]  798 	addw	sp, #4
      000453 85               [ 2]  799 	popw	x
      000454 16 01            [ 2]  800 	ldw	y, (0x01, sp)
      000456 90 F7            [ 1]  801 	ld	(y), a
      000458                        802 00114$:
                                    803 ;	driver/modbus.c: 145: modbus_virtual_read(address);
      000458 89               [ 2]  804 	pushw	x
      000459 1E 3F            [ 2]  805 	ldw	x, (0x3f, sp)
      00045B 89               [ 2]  806 	pushw	x
      00045C CDr00rF9         [ 4]  807 	call	_modbus_virtual_read
      00045F 5B 04            [ 2]  808 	addw	sp, #4
                                    809 ;	driver/modbus.c: 146: modbus_buff[3]=0;
      000461 1E 24            [ 2]  810 	ldw	x, (0x24, sp)
      000463 7F               [ 1]  811 	clr	(x)
                                    812 ;	driver/modbus.c: 147: modbus_buff[2]=2;// 字节数
      000464 1E 22            [ 2]  813 	ldw	x, (0x22, sp)
      000466 A6 02            [ 1]  814 	ld	a, #0x02
      000468 F7               [ 1]  815 	ld	(x), a
                                    816 ;	driver/modbus.c: 149: u16 crc=CRC16(modbus_buff,5);
      000469 4B 05            [ 1]  817 	push	#0x05
      00046B 4Br00            [ 1]  818 	push	#<_modbus_buff
      00046D 4Bs00            [ 1]  819 	push	#(_modbus_buff >> 8)
      00046F CDr00r00         [ 4]  820 	call	_CRC16
      000472 5B 03            [ 2]  821 	addw	sp, #3
                                    822 ;	driver/modbus.c: 150: modbus_buff[5]=crc&0xff;
      000474 9F               [ 1]  823 	ld	a, xl
      000475 16 0C            [ 2]  824 	ldw	y, (0x0c, sp)
      000477 90 F7            [ 1]  825 	ld	(y), a
                                    826 ;	driver/modbus.c: 151: modbus_buff[6]=crc>>8;
      000479 9E               [ 1]  827 	ld	a, xh
      00047A 1E 1D            [ 2]  828 	ldw	x, (0x1d, sp)
      00047C F7               [ 1]  829 	ld	(x), a
                                    830 ;	driver/modbus.c: 154: modbus_send(7);
      00047D 4B 07            [ 1]  831 	push	#0x07
      00047F CDr00r55         [ 4]  832 	call	_modbus_send
      000482 84               [ 1]  833 	pop	a
      000483                        834 00119$:
                                    835 ;	driver/modbus.c: 157: }
      000483 5B 40            [ 2]  836 	addw	sp, #64
      000485 81               [ 4]  837 	ret
                                    838 	.area CODE
                                    839 	.area CONST
                                    840 	.area INITIALIZER
      000000                        841 __xinit__modbus_status:
      000000 00                     842 	.db #0x00	; 0
                                    843 	.area CABS (ABS)
